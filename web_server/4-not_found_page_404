#!/usr/bin/env bash
# Configure Nginx to serve a custom 404 page with a required string on Ubuntu 16.04

# Create the custom 404 page
echo "Ceci n'est pas une page" > /usr/share/nginx/html/custom_404.html

# Backup current default config
cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak

# Modify the default Nginx server config
sed -i '/server_name _;/a \    error_page 404 /custom_404.html;\n\n    location = /custom_404.html {\n        root /usr/share/nginx/html;\n        internal;\n    }' /etc/nginx/sites-available/default

# Reload Nginx to apply changes without using systemctl
service nginx reload
